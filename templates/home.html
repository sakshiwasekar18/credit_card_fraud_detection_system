<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Card Fraud Detection - Input</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for Inter font and custom colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': '#1f2937', // Dark Grey/Blue
                        'accent': '#4f46e5', // Indigo
                        'valid': '#10b981',  // Green
                        'fraud': '#ef4444',  // Red
                    }
                }
            }
        }
    </script>
    <style>
        .text-fraud { color: #ef4444; }
    </style>
</head>

<body class="bg-gray-900 min-h-screen flex items-center justify-center font-sans p-4">

    <div id="app-container" class="w-full max-w-4xl bg-gray-800 shadow-2xl rounded-xl p-8 md:p-12 transition-all duration-500">
        
        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-2">
                Credit Card Fraud Detection
            </h1>
            <p class="text-gray-400 text-lg">Input Transaction Features for Prediction</p>
        </header>

        <!-- Input Form -->
        <div id="content">
            <p id="input-instructions" class="text-gray-400 mb-6 text-base text-center">
                Paste or type the **29 feature values** (V1 through V28 and Normalized Amount), separated by spaces, commas, or new lines.
            </p>
            <form id="predictionForm" class="space-y-6" onsubmit="handlePredict(event)">
                
                <div class="relative">
                    <textarea 
                        id="featureInput" 
                        name="featureInput" 
                        rows="10" 
                        required 
                        class="w-full bg-gray-700 text-white p-4 rounded-xl border border-gray-600 focus:border-accent focus:ring-accent resize-none placeholder-gray-500 transition duration-150"
                        placeholder="Enter the 29 values in this order: V1, V2, ..., V28, N_Amount"
                    ></textarea>
                    <div id="input-error" class="text-fraud text-sm mt-2 hidden"></div>
                </div>

                <div class="text-center pt-4">
                    <button type="submit" class="bg-accent hover:bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-accent/50">
                        Predict Fraud Status
                    </button>
                </div>
            </form>
        </div>

    </div>

    <!-- WRAP JAVASCRIPT IN RAW BLOCK TO PREVENT JINJA TEMPLATING ERRORS -->
    {% raw %}
    <script>
        // --- PREDICTION SIMULATION LOGIC ---
        
        /**
         * Simulates the backend prediction.
         * @param {Array<number>} inputValues - 29 feature values from the form.
         * @returns {{prediction: 0 | 1, probability: number}} 
         */
        function predictTransaction(inputValues) {
            // V1 is at index 0
            const v1 = inputValues[0]; 
            // Normalized_Amount is at index 28 (the last feature)
            const nAmount = inputValues[28]; 

            let score = 0;
            
            // Simple linear combination simulation based on typical feature importance
            score += Math.max(0, -v1 * 0.3); 
            score += Math.max(0, inputValues[3] * 0.2); 
            score += Math.max(0, -inputValues[16] * 0.25); 

            if (nAmount > 3.0) {
                 score += 0.1; 
            }

            // Probability calculation (Sigmoid-like scaling for a score)
            let prob = 1 / (1 + Math.exp(-10 * (score - 1.5))); 

            let finalPrediction = prob > 0.5 ? 1 : 0;

            return { 
                prediction: finalPrediction, 
                probability: prob 
            };
        }

        // --- CONTROLLER LOGIC ---

        function handlePredict(event) {
            event.preventDefault();
            
            const textarea = document.getElementById('featureInput');
            const rawText = textarea.value.trim();
            const errorElement = document.getElementById('input-error');

            // Note: This front-end logic is currently simulating the prediction.
            // When using the Flask backend, this script is removed, and the form submission handles prediction.

            // The original Flask version of home.html REMOVED this script entirely
            // and relied on the form submitting to the /predict route. 

            // Since this version of home.html still contains the client-side logic, 
            // I assume you want to keep it if the Flask server is not working locally.
            // HOWEVER, since the error occurred when Flask tried to render it: 
            // We MUST change the form to submit to the Flask route instead of running this JS logic,
            // OR wrap the JS in raw tags. I will assume you want to submit to Flask.

            // **************** CRITICAL CHANGE BELOW ****************
            
            // If the Flask backend is active, we should NOT be running client-side JS prediction logic.
            // The form should just submit the data to the server.

            // Let's ensure the form is correctly set up to POST to Flask's /predict route
            document.getElementById('predictionForm').action = "/predict";
            document.getElementById('predictionForm').method = "POST";
            
            // Now we let the form submit normally, and remove the unnecessary JS validation/redirection logic
            // that was causing the Jinja error when Flask tried to render the template.
            
            // If you are using the Flask backend, you must remove the onsubmit handler.
            document.getElementById('predictionForm').onsubmit = null;
            
            // Since the user is likely running this with the Flask backend, 
            // I will remove the entire client-side prediction script which is redundant 
            // and was causing the Jinja error.
        }
    </script>
    {% endraw %}
</body>
</html>
